/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/arcgis-pbf-parser@0.0.1/dist/arcgis-pbf.esm.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e from"../pbf@3.2.1/_esm.js";var t,r=t={};function a(r){let a;try{a=t.read(new e(r))}catch(e){throw new Error("Could not parse arcgis-pbf buffer")}const s=a.queryResult.featureResult,u=s.transform,c=s.geometryType,f=s.objectIdFieldName,y=s.fields;for(let e=0;e<y.length;e++){const t=y[e];t.keyName=p(t)}const F={type:"FeatureCollection",features:[]},v=function(e){switch(e){case 3:default:return n;case 2:return l;case 0:return i}}(c),m=s.features.length;for(let e=0;e<m;e++){const t=s.features[e];F.features.push({type:"Feature",id:d(y,t.attributes,f),properties:o(y,t.attributes),geometry:v(t,u)})}return{featureCollection:F,exceededTransferLimit:s.exceededTransferLimit}}function i(e,t){return{type:"Point",coordinates:c(e.geometry.coords,t)}}function l(e,t){return{type:"LineString",coordinates:u(e.geometry.coords,t,0,2*e.geometry.lengths[0])}}function n(e,t){const r=e.geometry.lengths.length,a={type:"Polygon",coordinates:[]};if(1===r)a.coordinates.push(u(e.geometry.coords,t,0,2*e.geometry.lengths[0]));else{a.type="MultiPolygon";let i=0;for(let l=0;l<r;l++){const r=i+2*e.geometry.lengths[l],n=u(e.geometry.coords,t,i,r);s(n)?a.coordinates.push([n]):a.coordinates.length>0&&a.coordinates[a.coordinates.length-1].push(n),i=r}}return a}function s(e){for(var t,r=0,a=0,i=e.length,l=e[a];a<i-1;a++)r+=((t=e[a+1])[0]-l[0])*(t[1]+l[1]),l=t;return r>=0}function u(e,t,r,a){const i=[];if(0===e.length)return i;const l=e[r],n=e[r+1];i.push(c([l,n],t));let s=l,u=n;for(let l=r+2;l<a;l+=2){const r=f(s,e[l]),a=f(u,e[l+1]),n=c([r,a],t);i.push(n),s=r,u=a}return i}function o(e,t){const r={};for(let a=0;a<e.length;a++){const i=e[a];t[a][t[a].value_type]?r[i.name]=t[a][t[a].value_type]:r[i.name]=null}return r}function d(e,t,r){for(let a=0;a<e.length;a++){if(e[a].name===r)return t[a][t[a].value_type]}return null}function p(e){switch(e.fieldType){case 1:return"sintValue";case 2:return"floatValue";case 3:return"doubleValue";case 4:return"stringValue";case 5:return"sint64Value";case 6:return"uintValue";default:return null}}function c(e,t){let r=e[0],a=e[1],i=e[2]?e[2]:void 0;t.scale&&(r*=t.scale.xScale,a*=-t.scale.yScale,void 0!==i&&(i*=t.scale.zScale)),t.translate&&(r+=t.translate.xTranslate,a+=t.translate.yTranslate,void 0!==i&&(i+=t.translate.zTranslate));const l=[r,a];return void 0!==i&&l.push(i),l}function f(e,t){return e+t}r.read=function(e,t){return e.readFields(r._readField,{version:"",queryResult:null},t)},r._readField=function(e,t,a){1===e?t.version=a.readString():2===e&&(t.queryResult=r.QueryResult.read(a,a.readVarint()+a.pos))},r.write=function(e,t){e.version&&t.writeStringField(1,e.version),e.queryResult&&t.writeMessage(2,r.QueryResult.write,e.queryResult)},r.GeometryType={esriGeometryTypePoint:{value:0,options:{}},esriGeometryTypeMultipoint:{value:1,options:{}},esriGeometryTypePolyline:{value:2,options:{}},esriGeometryTypePolygon:{value:3,options:{}},esriGeometryTypeMultipatch:{value:4,options:{}},esriGeometryTypeNone:{value:127,options:{}}},r.FieldType={esriFieldTypeSmallInteger:{value:0,options:{}},esriFieldTypeInteger:{value:1,options:{}},esriFieldTypeSingle:{value:2,options:{}},esriFieldTypeDouble:{value:3,options:{}},esriFieldTypeString:{value:4,options:{}},esriFieldTypeDate:{value:5,options:{}},esriFieldTypeOID:{value:6,options:{}},esriFieldTypeGeometry:{value:7,options:{}},esriFieldTypeBlob:{value:8,options:{}},esriFieldTypeRaster:{value:9,options:{}},esriFieldTypeGUID:{value:10,options:{}},esriFieldTypeGlobalID:{value:11,options:{}},esriFieldTypeXML:{value:12,options:{}}},r.SQLType={sqlTypeBigInt:{value:0,options:{}},sqlTypeBinary:{value:1,options:{}},sqlTypeBit:{value:2,options:{}},sqlTypeChar:{value:3,options:{}},sqlTypeDate:{value:4,options:{}},sqlTypeDecimal:{value:5,options:{}},sqlTypeDouble:{value:6,options:{}},sqlTypeFloat:{value:7,options:{}},sqlTypeGeometry:{value:8,options:{}},sqlTypeGUID:{value:9,options:{}},sqlTypeInteger:{value:10,options:{}},sqlTypeLongNVarchar:{value:11,options:{}},sqlTypeLongVarbinary:{value:12,options:{}},sqlTypeLongVarchar:{value:13,options:{}},sqlTypeNChar:{value:14,options:{}},sqlTypeNVarchar:{value:15,options:{}},sqlTypeOther:{value:16,options:{}},sqlTypeReal:{value:17,options:{}},sqlTypeSmallInt:{value:18,options:{}},sqlTypeSqlXml:{value:19,options:{}},sqlTypeTime:{value:20,options:{}},sqlTypeTimestamp:{value:21,options:{}},sqlTypeTimestamp2:{value:22,options:{}},sqlTypeTinyInt:{value:23,options:{}},sqlTypeVarbinary:{value:24,options:{}},sqlTypeVarchar:{value:25,options:{}}},r.QuantizeOriginPostion={upperLeft:{value:0,options:{}},lowerLeft:{value:1,options:{}}},r.SpatialReference={},r.SpatialReference.read=function(e,t){return e.readFields(r.SpatialReference._readField,{wkid:0,lastestWkid:0,vcsWkid:0,latestVcsWkid:0,wkt:""},t)},r.SpatialReference._readField=function(e,t,r){1===e?t.wkid=r.readVarint():2===e?t.lastestWkid=r.readVarint():3===e?t.vcsWkid=r.readVarint():4===e?t.latestVcsWkid=r.readVarint():5===e&&(t.wkt=r.readString())},r.SpatialReference.write=function(e,t){e.wkid&&t.writeVarintField(1,e.wkid),e.lastestWkid&&t.writeVarintField(2,e.lastestWkid),e.vcsWkid&&t.writeVarintField(3,e.vcsWkid),e.latestVcsWkid&&t.writeVarintField(4,e.latestVcsWkid),e.wkt&&t.writeStringField(5,e.wkt)},r.Field={},r.Field.read=function(e,t){return e.readFields(r.Field._readField,{name:"",fieldType:0,alias:"",sqlType:0,domain:"",defaultValue:""},t)},r.Field._readField=function(e,t,r){1===e?t.name=r.readString():2===e?t.fieldType=r.readVarint():3===e?t.alias=r.readString():4===e?t.sqlType=r.readVarint():5===e?t.domain=r.readString():6===e&&(t.defaultValue=r.readString())},r.Field.write=function(e,t){e.name&&t.writeStringField(1,e.name),e.fieldType&&t.writeVarintField(2,e.fieldType),e.alias&&t.writeStringField(3,e.alias),e.sqlType&&t.writeVarintField(4,e.sqlType),e.domain&&t.writeStringField(5,e.domain),e.defaultValue&&t.writeStringField(6,e.defaultValue)},r.Value={},r.Value.read=function(e,t){return e.readFields(r.Value._readField,{string_value:"",value_type:null,float_value:0,double_value:0,sint_value:0,uint_value:0,int64_value:0,uint64_value:0,sint64_value:0,bool_value:!1},t)},r.Value._readField=function(e,t,r){1===e?(t.string_value=r.readString(),t.value_type="string_value"):2===e?(t.float_value=r.readFloat(),t.value_type="float_value"):3===e?(t.double_value=r.readDouble(),t.value_type="double_value"):4===e?(t.sint_value=r.readSVarint(),t.value_type="sint_value"):5===e?(t.uint_value=r.readVarint(),t.value_type="uint_value"):6===e?(t.int64_value=r.readVarint(!0),t.value_type="int64_value"):7===e?(t.uint64_value=r.readVarint(),t.value_type="uint64_value"):8===e?(t.sint64_value=r.readSVarint(),t.value_type="sint64_value"):9===e&&(t.bool_value=r.readBoolean(),t.value_type="bool_value")},r.Value.write=function(e,t){e.string_value&&t.writeStringField(1,e.string_value),e.float_value&&t.writeFloatField(2,e.float_value),e.double_value&&t.writeDoubleField(3,e.double_value),e.sint_value&&t.writeSVarintField(4,e.sint_value),e.uint_value&&t.writeVarintField(5,e.uint_value),e.int64_value&&t.writeVarintField(6,e.int64_value),e.uint64_value&&t.writeVarintField(7,e.uint64_value),e.sint64_value&&t.writeSVarintField(8,e.sint64_value),e.bool_value&&t.writeBooleanField(9,e.bool_value)},r.Geometry={},r.Geometry.read=function(e,t){return e.readFields(r.Geometry._readField,{lengths:[],coords:[]},t)},r.Geometry._readField=function(e,t,r){2===e?r.readPackedVarint(t.lengths):3===e&&r.readPackedSVarint(t.coords)},r.Geometry.write=function(e,t){e.lengths&&t.writePackedVarint(2,e.lengths),e.coords&&t.writePackedSVarint(3,e.coords)},r.esriShapeBuffer={},r.esriShapeBuffer.read=function(e,t){return e.readFields(r.esriShapeBuffer._readField,{bytes:null},t)},r.esriShapeBuffer._readField=function(e,t,r){1===e&&(t.bytes=r.readBytes())},r.esriShapeBuffer.write=function(e,t){e.bytes&&t.writeBytesField(1,e.bytes)},r.Feature={},r.Feature.read=function(e,t){return e.readFields(r.Feature._readField,{attributes:[],geometry:null,compressed_geometry:null,shapeBuffer:null,centroid:null},t)},r.Feature._readField=function(e,t,a){1===e?t.attributes.push(r.Value.read(a,a.readVarint()+a.pos)):2===e?(t.geometry=r.Geometry.read(a,a.readVarint()+a.pos),t.compressed_geometry="geometry"):3===e?(t.shapeBuffer=r.esriShapeBuffer.read(a,a.readVarint()+a.pos),t.compressed_geometry="shapeBuffer"):4===e&&(t.centroid=r.Geometry.read(a,a.readVarint()+a.pos))},r.Feature.write=function(e,t){if(e.attributes)for(var a=0;a<e.attributes.length;a++)t.writeMessage(1,r.Value.write,e.attributes[a]);e.geometry&&t.writeMessage(2,r.Geometry.write,e.geometry),e.shapeBuffer&&t.writeMessage(3,r.esriShapeBuffer.write,e.shapeBuffer),e.centroid&&t.writeMessage(4,r.Geometry.write,e.centroid)},r.UniqueIdField={},r.UniqueIdField.read=function(e,t){return e.readFields(r.UniqueIdField._readField,{name:"",isSystemMaintained:!1},t)},r.UniqueIdField._readField=function(e,t,r){1===e?t.name=r.readString():2===e&&(t.isSystemMaintained=r.readBoolean())},r.UniqueIdField.write=function(e,t){e.name&&t.writeStringField(1,e.name),e.isSystemMaintained&&t.writeBooleanField(2,e.isSystemMaintained)},r.GeometryProperties={},r.GeometryProperties.read=function(e,t){return e.readFields(r.GeometryProperties._readField,{shapeAreaFieldName:"",shapeLengthFieldName:"",units:""},t)},r.GeometryProperties._readField=function(e,t,r){1===e?t.shapeAreaFieldName=r.readString():2===e?t.shapeLengthFieldName=r.readString():3===e&&(t.units=r.readString())},r.GeometryProperties.write=function(e,t){e.shapeAreaFieldName&&t.writeStringField(1,e.shapeAreaFieldName),e.shapeLengthFieldName&&t.writeStringField(2,e.shapeLengthFieldName),e.units&&t.writeStringField(3,e.units)},r.ServerGens={},r.ServerGens.read=function(e,t){return e.readFields(r.ServerGens._readField,{minServerGen:0,serverGen:0},t)},r.ServerGens._readField=function(e,t,r){1===e?t.minServerGen=r.readVarint():2===e&&(t.serverGen=r.readVarint())},r.ServerGens.write=function(e,t){e.minServerGen&&t.writeVarintField(1,e.minServerGen),e.serverGen&&t.writeVarintField(2,e.serverGen)},r.Scale={},r.Scale.read=function(e,t){return e.readFields(r.Scale._readField,{xScale:0,yScale:0,mScale:0,zScale:0},t)},r.Scale._readField=function(e,t,r){1===e?t.xScale=r.readDouble():2===e?t.yScale=r.readDouble():3===e?t.mScale=r.readDouble():4===e&&(t.zScale=r.readDouble())},r.Scale.write=function(e,t){e.xScale&&t.writeDoubleField(1,e.xScale),e.yScale&&t.writeDoubleField(2,e.yScale),e.mScale&&t.writeDoubleField(3,e.mScale),e.zScale&&t.writeDoubleField(4,e.zScale)},r.Translate={},r.Translate.read=function(e,t){return e.readFields(r.Translate._readField,{xTranslate:0,yTranslate:0,mTranslate:0,zTranslate:0},t)},r.Translate._readField=function(e,t,r){1===e?t.xTranslate=r.readDouble():2===e?t.yTranslate=r.readDouble():3===e?t.mTranslate=r.readDouble():4===e&&(t.zTranslate=r.readDouble())},r.Translate.write=function(e,t){e.xTranslate&&t.writeDoubleField(1,e.xTranslate),e.yTranslate&&t.writeDoubleField(2,e.yTranslate),e.mTranslate&&t.writeDoubleField(3,e.mTranslate),e.zTranslate&&t.writeDoubleField(4,e.zTranslate)},r.Transform={},r.Transform.read=function(e,t){return e.readFields(r.Transform._readField,{quantizeOriginPostion:0,scale:null,translate:null},t)},r.Transform._readField=function(e,t,a){1===e?t.quantizeOriginPostion=a.readVarint():2===e?t.scale=r.Scale.read(a,a.readVarint()+a.pos):3===e&&(t.translate=r.Translate.read(a,a.readVarint()+a.pos))},r.Transform.write=function(e,t){e.quantizeOriginPostion&&t.writeVarintField(1,e.quantizeOriginPostion),e.scale&&t.writeMessage(2,r.Scale.write,e.scale),e.translate&&t.writeMessage(3,r.Translate.write,e.translate)},r.FeatureResult={},r.FeatureResult.read=function(e,t){return e.readFields(r.FeatureResult._readField,{objectIdFieldName:"",uniqueIdField:null,globalIdFieldName:"",geohashFieldName:"",geometryProperties:null,serverGens:null,geometryType:0,spatialReference:null,exceededTransferLimit:!1,hasZ:!1,hasM:!1,transform:null,fields:[],values:[],features:[]},t)},r.FeatureResult._readField=function(e,t,a){1===e?t.objectIdFieldName=a.readString():2===e?t.uniqueIdField=r.UniqueIdField.read(a,a.readVarint()+a.pos):3===e?t.globalIdFieldName=a.readString():4===e?t.geohashFieldName=a.readString():5===e?t.geometryProperties=r.GeometryProperties.read(a,a.readVarint()+a.pos):6===e?t.serverGens=r.ServerGens.read(a,a.readVarint()+a.pos):7===e?t.geometryType=a.readVarint():8===e?t.spatialReference=r.SpatialReference.read(a,a.readVarint()+a.pos):9===e?t.exceededTransferLimit=a.readBoolean():10===e?t.hasZ=a.readBoolean():11===e?t.hasM=a.readBoolean():12===e?t.transform=r.Transform.read(a,a.readVarint()+a.pos):13===e?t.fields.push(r.Field.read(a,a.readVarint()+a.pos)):14===e?t.values.push(r.Value.read(a,a.readVarint()+a.pos)):15===e&&t.features.push(r.Feature.read(a,a.readVarint()+a.pos))},r.FeatureResult.write=function(e,t){if(e.objectIdFieldName&&t.writeStringField(1,e.objectIdFieldName),e.uniqueIdField&&t.writeMessage(2,r.UniqueIdField.write,e.uniqueIdField),e.globalIdFieldName&&t.writeStringField(3,e.globalIdFieldName),e.geohashFieldName&&t.writeStringField(4,e.geohashFieldName),e.geometryProperties&&t.writeMessage(5,r.GeometryProperties.write,e.geometryProperties),e.serverGens&&t.writeMessage(6,r.ServerGens.write,e.serverGens),e.geometryType&&t.writeVarintField(7,e.geometryType),e.spatialReference&&t.writeMessage(8,r.SpatialReference.write,e.spatialReference),e.exceededTransferLimit&&t.writeBooleanField(9,e.exceededTransferLimit),e.hasZ&&t.writeBooleanField(10,e.hasZ),e.hasM&&t.writeBooleanField(11,e.hasM),e.transform&&t.writeMessage(12,r.Transform.write,e.transform),e.fields)for(var a=0;a<e.fields.length;a++)t.writeMessage(13,r.Field.write,e.fields[a]);if(e.values)for(a=0;a<e.values.length;a++)t.writeMessage(14,r.Value.write,e.values[a]);if(e.features)for(a=0;a<e.features.length;a++)t.writeMessage(15,r.Feature.write,e.features[a])},r.CountResult={},r.CountResult.read=function(e,t){return e.readFields(r.CountResult._readField,{count:0},t)},r.CountResult._readField=function(e,t,r){1===e&&(t.count=r.readVarint())},r.CountResult.write=function(e,t){e.count&&t.writeVarintField(1,e.count)},r.ObjectIdsResult={},r.ObjectIdsResult.read=function(e,t){return e.readFields(r.ObjectIdsResult._readField,{objectIdFieldName:"",serverGens:null,objectIds:[]},t)},r.ObjectIdsResult._readField=function(e,t,a){1===e?t.objectIdFieldName=a.readString():2===e?t.serverGens=r.ServerGens.read(a,a.readVarint()+a.pos):3===e&&a.readPackedVarint(t.objectIds)},r.ObjectIdsResult.write=function(e,t){e.objectIdFieldName&&t.writeStringField(1,e.objectIdFieldName),e.serverGens&&t.writeMessage(2,r.ServerGens.write,e.serverGens),e.objectIds&&t.writePackedVarint(3,e.objectIds)},r.QueryResult={},r.QueryResult.read=function(e,t){return e.readFields(r.QueryResult._readField,{featureResult:null,Results:null,countResult:null,idsResult:null},t)},r.QueryResult._readField=function(e,t,a){1===e?(t.featureResult=r.FeatureResult.read(a,a.readVarint()+a.pos),t.Results="featureResult"):2===e?(t.countResult=r.CountResult.read(a,a.readVarint()+a.pos),t.Results="countResult"):3===e&&(t.idsResult=r.ObjectIdsResult.read(a,a.readVarint()+a.pos),t.Results="idsResult")},r.QueryResult.write=function(e,t){e.featureResult&&t.writeMessage(1,r.FeatureResult.write,e.featureResult),e.countResult&&t.writeMessage(2,r.CountResult.write,e.countResult),e.idsResult&&t.writeMessage(3,r.ObjectIdsResult.write,e.idsResult)};export{a as default};
